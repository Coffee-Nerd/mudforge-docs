# Protocol Reference

MudForge receives game data via GMCP or MSDP protocols. This reference explains what data is used and how to configure it for your MUD.

---

## What is GMCP/MSDP?

These protocols let your MUD send structured data to the client:
- **GMCP** - Generic MUD Communication Protocol (JSON-based)
- **MSDP** - MUD Server Data Protocol (simpler key-value format)

Most modern MUDs support at least one of these.

---

## Status Bar Data

The status bar needs these fields:

### Health/Mana/Movement

| Data | GMCP Field | MSDP Variables |
|------|------------|----------------|
| Current HP | `Char.Vitals.hp` | HEALTH, HP |
| Max HP | `Char.Vitals.maxhp` | HEALTH_MAX, HP_MAX |
| Current Mana | `Char.Vitals.mana` | MANA, MN |
| Max Mana | `Char.Vitals.maxmana` | MANA_MAX, MN_MAX |
| Current Move | `Char.Vitals.movement` | MOVEMENT, MV |
| Max Move | `Char.Vitals.maxmove` | MOVEMENT_MAX, MV_MAX |

### Character Info

| Data | GMCP Field | MSDP Variable |
|------|------------|---------------|
| Name | `Char.Base.name` | CHARACTER_NAME |
| Level | `Char.Base.level` | LEVEL |
| Class | `Char.Base.class` | CLASS |
| Race | `Char.Base.race` | RACE |

---

## Map Data

The mapper needs room information:

| Data | GMCP Field | MSDP Variable |
|------|------------|---------------|
| Room ID | `Room.Info.num` | ROOM_VNUM |
| Room Name | `Room.Info.name` | ROOM_NAME |
| Zone | `Room.Info.zone` | ROOM_ZONE |
| Terrain | `Room.Info.terrain` | ROOM_TERRAIN |
| Exits | `Room.Info.exits` | ROOM_EXITS |

---

## Group Data

The group widget needs:

| Data | GMCP Package |
|------|--------------|
| Party Members | `Group.Members` |
| Enemies | `Group.Enemies` |

---

## Enabling Protocols

### On Your MUD

Many MUDs require you to enable GMCP in your account settings:
1. Log into your MUD
2. Look for settings or configuration commands
3. Enable GMCP or "Client Communication"

### In MudForge

Protocols are enabled by default. Check **Settings → Debug** for:
- MXP settings
- MCCP (compression) settings

---

## Debugging

If widgets aren't receiving data:

1. **Check protocol support**: Not all MUDs support GMCP/MSDP
2. **Enable in your account**: Some MUDs require opt-in
3. **View raw data**: Type `gmcpdebug` or `msdpdebug` in the terminal
4. **Configure field mappings**: Map Widget has protocol configuration

---

## Configuring Field Mappings

If your MUD uses different field names, you can configure the mapper:

1. Open Map Widget settings
2. Go to Protocol Configuration
3. Choose GMCP or MSDP
4. Edit the field mappings to match your MUD

### Common Variations

| Standard | Some MUDs Use |
|----------|---------------|
| `num` | `vnum`, `id` |
| `zone` | `area`, `region` |
| `terrain` | `environment`, `sector` |
| `x`, `y`, `z` | `coord.x`, `coord.y`, `coord.z` |

---

## Protocol Echo Color

When debug mode is on, protocol messages appear in yellow (xterm color 220).

You can change this in **Settings → Debug → Protocol Echo Color**.
